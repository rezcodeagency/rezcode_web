---
/**
 * PROJECT COMPONENT - FARELL RHEZKY ALVIANTO
 * Optimized Spacing: Mengurangi padding bawah agar menyatu mulus dengan Tech Stack.
 */
import { ExternalLink, ChevronLeft, ChevronRight } from "lucide-react";
import projects from "../../data/projects.json";
import { Image } from "astro:assets";
---

<section id="project" class="pt-20 pb-10 md:pt-28 md:pb-16 bg-[#020406] relative overflow-hidden">
  <div class="absolute inset-0 bg-[radial-gradient(circle_at_top_right,_var(--tw-gradient-stops))] from-brand-primary/[0.02] via-transparent to-transparent pointer-events-none"></div>

  <div class="max-w-6xl mx-auto px-6 relative z-10">
    
    <div class="mb-10 md:mb-14 flex flex-col md:flex-row md:items-end justify-between gap-8">
      <div>        
        <h2 class="text-4xl md:text-5xl font-extrabold text-white tracking-tighter leading-[0.9]">
          Selected <span class="text-white/40 italic font-medium">Missions.</span>
        </h2>
      </div>
      
      <div class="hidden md:flex gap-3">
        <button id="prev-slide" class="w-10 h-10 rounded-full border border-white/10 flex items-center justify-center text-white/40 hover:border-brand-primary hover:text-brand-primary transition-all">
          <ChevronLeft size={18} />
        </button>
        <button id="next-slide" class="w-10 h-10 rounded-full border border-white/10 flex items-center justify-center text-white/40 hover:border-brand-primary hover:text-brand-primary transition-all">
          <ChevronRight size={18} />
        </button>
      </div>
    </div>

    <div 
      id="slider-container" 
      class="flex gap-5 md:gap-8 overflow-x-auto snap-x snap-mandatory scrollbar-hide -mx-6 px-6 md:mx-0 md:px-0 scroll-smooth pb-4"
    >
      {projects.map((project, index) => (
        <article class="min-w-[85vw] md:min-w-[400px] lg:min-w-[480px] snap-start group flex flex-col">
          <div class="relative aspect-[16/10] overflow-hidden rounded-2xl bg-white/[0.02] border border-white/5 mb-6 transition-all duration-500 group-hover:border-brand-primary/30">
            {project.image ? (
              <Image
                src={project.image}
                alt={project.title}
                width={800}
                height={500}
                class="absolute inset-0 w-full h-full object-cover grayscale transition-all duration-700 group-hover:grayscale-0 group-hover:scale-105"
              />
            ) : (
              <div class="absolute inset-0 flex items-center justify-center text-5xl opacity-5 font-bold italic">
                {index + 1}
              </div>
            )}
            
            <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all duration-500 flex items-center justify-center backdrop-blur-[2px]">
               <a href={project.link} target="_blank" class="px-5 py-2.5 bg-white text-black rounded-full font-bold text-[9px] uppercase tracking-widest flex items-center gap-2 hover:bg-brand-primary hover:text-white transition-all">
                View Project <ExternalLink size={12} />
              </a>
            </div>
          </div>

          <div class="flex flex-col flex-1 px-1">
            <span class="text-[9px] font-bold text-brand-primary uppercase tracking-[0.2em] mb-3">
              {project.client}
            </span>
            <h3 class="text-xl font-bold text-white mb-3 tracking-tight group-hover:text-brand-primary transition-colors">
              {project.title}
            </h3>
            <p class="text-slate-500 text-xs leading-relaxed mb-6 line-clamp-2">
              {project.description}
            </p>
            <div class="flex flex-wrap gap-x-4 gap-y-2 pt-4 border-t border-white/5 mt-auto">
              {project.tech.slice(0, 3).map((t) => (
                <span class="text-[8px] font-bold text-white/20 uppercase tracking-widest">
                  {t}
                </span>
              ))}
            </div>
          </div>
        </article>
      ))}
    </div>

    <div class="flex md:hidden justify-center gap-2 mt-6">
        {projects.map((_, i) => (
            <div class={`w-1 h-1 rounded-full transition-all duration-300 slide-dot ${i === 0 ? 'bg-brand-primary w-3' : 'bg-white/10'}`} data-index={i}></div>
        ))}
    </div>
  </div>
</section>

<script>
  const container = document.getElementById('slider-container');
  const prevBtn = document.getElementById('prev-slide');
  const nextBtn = document.getElementById('next-slide');
  const dots = document.querySelectorAll('.slide-dot');

  if (container) {
    nextBtn?.addEventListener('click', () => container.scrollBy({ left: 400, behavior: 'smooth' }));
    prevBtn?.addEventListener('click', () => container.scrollBy({ left: -400, behavior: 'smooth' }));

    container.addEventListener('scroll', () => {
        const index = Math.round(container.scrollLeft / (window.innerWidth * 0.85));
        dots.forEach((dot, i) => {
            dot.classList.toggle('bg-brand-primary', i === index);
            dot.classList.toggle('w-3', i === index);
            dot.classList.toggle('bg-white/10', i !== index);
        });
    });
  }
</script>

<style>
  .scrollbar-hide::-webkit-scrollbar { display: none; }
  .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
</style>