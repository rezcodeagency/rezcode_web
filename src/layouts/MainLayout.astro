---
import siteData from "../data/site.json";
import "../styles/global.css";
import "aos/dist/aos.css";
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0"
    />
    <title>RezCode - Premium Digital Solutions</title>
    <meta
      name="description"
      content="RezCode delivers cutting-edge web solutions with futuristic design and unmatched performance."
    />

    <meta name="theme-color" content="#0c0f19" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />

    <link rel="icon" type="image/webp" href="/logo.webp" />
    <link rel="apple-touch-icon" href="/logo.webp" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap"
      rel="stylesheet"
    />

    <style is:inline>
      :root {
        --color-brand-dark: #0c0f19;
        --color-brand-primary: #3b65a4;
        --color-brand-secondary: #4080bf;
        --color-brand-light: #f8fbfd;
      }
      html {
        background-color: #0c0f19 !important;
      }
      body {
        background-color: #0c0f19;
        color: #f8fbfd;
        font-family: "Outfit", sans-serif;
        margin: 0;
        padding: 0;
      }
    </style>

    <link rel="preload" href="/logo.webp" as="image" />
    <link rel="manifest" href="/manifest.json" />
  </head>
  <body
    class="bg-brand-dark text-brand-light min-h-screen selection:bg-brand-primary selection:text-white"
  >
    <slot />

    <script>
      import AOS from "aos";

      // 1. Initialize AOS
      const initAOS = () => {
        AOS.init({
          duration: 500,
          easing: "ease-out-cubic",
          once: true,
          offset: 20,
          disable: window.innerWidth < 768 ? "mobile" : false,
        });
      };

      // Gunakan event load agar AOS tidak menghambat loading awal
      window.addEventListener("load", initAOS);

      // 2. Optimized Mouse Effect (Glow Cards)
      const isTouch = window.matchMedia("(pointer: coarse)").matches;

      if (!isTouch) {
        let frameRequested = false;
        let cards: { el: HTMLElement; rect: DOMRect }[] = [];

        const updateCardCache = () => {
          const cardElements = document.querySelectorAll(".glow-card");
          cards = Array.from(cardElements).map((el) => ({
            el: el as HTMLElement,
            rect: el.getBoundingClientRect(),
          }));
        };

        // Update rect saat scroll atau resize agar posisi mouse tetap akurat
        window.addEventListener("scroll", updateCardCache, { passive: true });
        window.addEventListener("resize", updateCardCache, { passive: true });

        // Initial cache
        updateCardCache();

        document.addEventListener("mousemove", (e) => {
          if (frameRequested || cards.length === 0) return;
          frameRequested = true;

          requestAnimationFrame(() => {
            const mouseX = e.clientX;
            const mouseY = e.clientY;

            cards.forEach((card) => {
              const x = mouseX - card.rect.left;
              const y = mouseY - card.rect.top;
              card.el.style.setProperty("--mouse-x", `${x}px`);
              card.el.style.setProperty("--mouse-y", `${y}px`);
            });
            frameRequested = false;
          });
        });
      }

      // 3. Click Ripple Effect
      document.addEventListener("click", (e) => {
        const ripple = document.createElement("div");
        ripple.classList.add("ripple");
        const size = 100;
        ripple.style.width = ripple.style.height = `${size}px`;
        ripple.style.left = `${e.clientX - size / 2}px`;
        ripple.style.top = `${e.clientY - size / 2}px`;
        document.body.appendChild(ripple);

        // Bersihkan element setelah animasi selesai
        ripple.addEventListener("animationend", () => ripple.remove());
      });
    </script>
  </body>
</html>
